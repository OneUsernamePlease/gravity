var E=Object.defineProperty;var M=(n,t,e)=>t in n?E(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var d=(n,t,e)=>M(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();class r{constructor(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=t,this.y=e}toString(){return`x: ${this.x}, y: ${this.y}`}static add(...t){return t.reduce((e,i)=>({x:e.x+i.x,y:e.y+i.y}),{x:0,y:0})}static subtract(t,e){return{x:t.x-e.x,y:t.y-e.y}}static scale(t,e){return{x:t.x*e,y:t.y*e}}static dotProduct(t,e){return t.x*e.x+t.y*e.y}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static normalize(t){const e=this.magnitude(t);return e===0?{x:0,y:0}:this.scale(t,1/e)}static distance(t,e){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}static displacementVector(t,e){return this.subtract(e,t)}static hadamardProduct(t,e){return{x:t.x*e.x,y:t.y*e.y}}}class p{constructor(t,e,i,o){d(this,"_mass");d(this,"_radius");d(this,"_color");d(this,"_movable");d(this,"defaultDensity",1);t===void 0&&(t=25),e===void 0&&(e=(3*this.mass/(4*Math.PI*this.defaultDensity))**(1/3)),i===void 0&&(i="white"),o===void 0&&(o=!0),this.mass=t,this.radius=e,this.color=i,this.movable=o}get mass(){return this._mass}set mass(t){this._mass=t}get radius(){return this._radius}set radius(t){this._radius=t}get movable(){return this._movable}set movable(t){this._movable=t}get color(){return this._color}set color(t){CSS.supports("color",t)||(t="white"),this._color=t}}class C{constructor(){d(this,"_objectStates");d(this,"running");d(this,"tickCount");d(this,"_tickLength");d(this,"_g");this._objectStates=[],this.running=!1,this.tickCount=0,this._tickLength=10,this._g=1}get objectStates(){return this._objectStates}set objectStates(t){this._objectStates=t}get tickLength(){return this._tickLength}set tickLength(t){this._tickLength=t}get g(){return this._g}set g(t){this._g=Math.max(t,Number.MIN_VALUE)}addObject(t){return t.body.movable||(t.velocity=new r(0,0),t.acceleration=new r(0,0)),this.objectStates.push(t),this.objectStates.length}clearObjects(){this.objectStates=[]}pause(){this.running=!1}nextState(){this.updateAccelerationVectors(),this.objectStates.forEach(t=>{this.updateVelocityAndPosition(t)}),this.tickCount++}updateAccelerationVectors(){const t=new Map;for(let e=0;e<this.objectStates.length;e++)for(let i=e+1;i<this.objectStates.length;i++){const o=this.calculateForceBetweenBodies(e,i),s=r.scale(o,-1);t.set(e,t.has(e)?r.add(t.get(e),o):o),t.set(i,t.has(i)?r.add(t.get(i),s):s)}this.objectStates.forEach((e,i)=>{const o=t.get(i);let s=o!==void 0?o:new r(0,0);s=r.scale(s,1/e.body.mass),e.acceleration=s})}updateVelocityAndPosition(t){const e=this.tickLength/1e3;t.body.movable&&(t.velocity=r.add(t.velocity,r.scale(t.acceleration,e)),t.position=r.add(t.position,r.scale(t.velocity,e)))}calculateForceBetweenBodies(t,e){const i=this.objectStates[t],o=this.objectStates[e],s=r.distance(i.position,o.position);if(s<1e-10)return new r(0,0);const m=this.g*(i.body.mass*o.body.mass/(s*s)),y=r.normalize(r.subtract(o.position,i.position));return r.scale(y,m)}run(){if(this.running)return;this.running=!0;const t=()=>{this.running&&(setTimeout(t,this.tickLength),this.nextState())};t()}log(t){const e=new Date,i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),m=e.getMilliseconds().toString().padStart(3,"0"),y=`${i}:${o}:${s}.${m}`;console.log(`[${y}] ${t}`)}}document.addEventListener("DOMContentLoaded",_);let l,a,S={fields:[]},u,c,T=25,g=!1,f=1;function _(){z(),O(),I(1280,720),c={origin:{x:0,y:0},zoomFactor:1,orientationY:-1},u=new C,document.removeEventListener("DOMContentLoaded",_)}function O(){var n,t,e,i;(n=document.getElementById("cvsBtnStartSim"))==null||n.addEventListener("click",H),(t=document.getElementById("cvsBtnToggleSim"))==null||t.addEventListener("click",D),(e=document.getElementById("cvsBtnZoomOut"))==null||e.addEventListener("click",j),(i=document.getElementById("cvsBtnZoomIn"))==null||i.addEventListener("click",A)}function z(){const n="statusText";let t=1,e=document.getElementById(n+t);for(;e!==null;)S.fields.push(e),t++,e=document.getElementById(n+t)}function h(n,t,e=!1){let i;typeof t=="number"?i=S.fields[t-1]:typeof t=="string"?i=document.getElementById(t):i=S.fields[0],e?i.innerHTML+=n:i.innerHTML=n}function I(n,t){l=document.getElementById("theCanvas"),l.width=n,l.height=t,a=l.getContext("2d"),h(`Canvas dimension: ${n} * ${t}`,5)}function B(n,t,e){e===void 0&&(e="white");let i=r.add(n,t);a.beginPath(),a.lineWidth=3,a.strokeStyle=e,a.moveTo(n.x,n.y),a.lineTo(i.x,i.y),a.stroke()}function P(n,t){let e=Math.max(n.radius/c.zoomFactor,1);a.beginPath(),a.arc(t.x,t.y,e,0,Math.PI*2),a.closePath(),a.fillStyle=n.color,a.fill()}function k(){u.objectStates.forEach(t=>{t!==null&&P(t.body,x(t.position))})}function F(){a.clearRect(0,0,l.width,l.height),k(),$()}function $(){u.objectStates.forEach(n=>{B(x(n.position),w(n.acceleration),"green"),B(x(n.position),w(n.velocity),"red")})}function x(n){const t=r.subtract(n,c.origin),e={x:t.x,y:t.y*-1};return r.scale(e,1/c.zoomFactor)}function w(n){const t={x:n.x,y:n.y*-1};return r.scale(t,1/c.zoomFactor)}function j(){const n={x:l.width/2,y:l.height/2},t=c.zoomFactor+f;let e=n.x*f,i=n.y*f;c.origin={x:c.origin.x-e,y:c.origin.y+i},c.zoomFactor=t,h(`Zoom: ${t} (m per pixel)`,4)}function A(){if(c.zoomFactor<=1)return;let n={x:l.width/2,y:l.height/2},t=c.zoomFactor-f,e=n.x*f,i=n.y*f;c.origin={x:c.origin.x+e,y:c.origin.y-i},c.zoomFactor=t,h(`Zoom: ${t} (m per pixel)`,4)}function V(){l.width,l.height;let n={x:640,y:-360},t={x:1140,y:-410},e={x:0,y:0},i={x:-110,y:-110};L(v(1e7,50),n,e),L(v(1e3),t,i)}function D(n){u.running?(g=!1,u.pause(),document.getElementById("cvsBtnToggleSim").innerHTML="Resume",h("Simulation paused",1)):(document.getElementById("cvsBtnToggleSim").innerHTML="Pause",N(),b(),h("Simulation running",1))}function L(n,t,e,i){n===void 0&&(n=v()),t===void 0&&(t={x:0,y:0}),e===void 0&&(e={x:0,y:0});const o={body:n,position:t,velocity:e,acceleration:{x:0,y:0}};u.addObject(o)}function H(){u.clearObjects(),u.tickCount=0,h("Simulation running",1),document.getElementById("cvsBtnToggleSim").innerHTML="Pause",V(),u.run(),b()}function N(){u.running||(u.run(),b())}function b(){if(g)return;g=!0;const n=()=>{g&&(F(),h(`Simulation Tick: ${u.tickCount}`,2),setTimeout(n,T))};n()}function v(n,t){let e;return n===void 0&&t===void 0?e=new p(Z(20,200)):t===void 0?e=new p(n):e=new p(n,t),e}function Z(n,t){return Math.floor(Math.random()*(t-n+1)+n)}
//# sourceMappingURL=index-ClVLcItH.js.map
