{"version":3,"file":"index-CLGABivq.js","sources":["../../../MyPackages/tcellib-vectors/dist/Vector2D/vector2d.js","../../src/scripts/gravity.ts","../../src/scripts/main.ts"],"sourcesContent":["export class Vector2D {\n    constructor(x, y) {\n        if (x === undefined) {\n            x = 0;\n        }\n        if (y === undefined) {\n            y = 0;\n        }\n        this.x = x;\n        this.y = y;\n    }\n    toString() {\n        return `x: ${this.x}, y: ${this.y}`;\n    }\n    static add(...vectors) {\n        return vectors.reduce((previous, current) => {\n            return { x: previous.x + current.x, y: previous.y + current.y };\n        }, { x: 0, y: 0 });\n    }\n    /**\n     * @returns v1 - v2\n     */\n    static subtract(v1, v2) {\n        return { x: v1.x - v2.x, y: v1.y - v2.y };\n    }\n    static scale(v, scalar) {\n        return { x: v.x * scalar, y: v.y * scalar };\n    }\n    static dotProduct(v1, v2) {\n        return v1.x * v2.x + v1.y * v2.y;\n    }\n    static magnitude(v) {\n        return Math.sqrt(v.x * v.x + v.y * v.y);\n    }\n    static normalize(v) {\n        const mag = this.magnitude(v);\n        return mag === 0 ? { x: 0, y: 0 } : this.scale(v, 1 / mag);\n    }\n    /**\n     * @param v1 Vector2D\n     * @param v2 Vector2D\n     * @returns Distance from v1 to v2\n     */\n    static distance(v1, v2) {\n        return Math.sqrt((v2.x - v1.x) ** 2 + (v2.y - v1.y) ** 2);\n    }\n    /**\n     * returns a vector pointing from v1 to v2\n     */\n    static displacementVector(v1, v2) {\n        return this.subtract(v2, v1);\n    }\n}\n","import { Vector2D } from \"tcellib-vectors\";\r\n\r\nexport class Body2d {\r\n    private _mass!: number;\r\n    private _radius!: number;\r\n    private _color!: string;\r\n    private _movable!: boolean; //whether the body will move from effects of gravity\r\n    private defaultDensity = 1;\r\n\r\n    //#region constructor, get, set\r\n    constructor(mass?: number, radius?: number, color?: string, movable?: boolean)  {\r\n        if (mass === undefined) { mass = 25; }\r\n        if (radius === undefined) { radius = ((3 * this.mass)/(4 * Math.PI * this.defaultDensity)) ** (1/3); }\r\n        if (color === undefined) { color = \"white\" }\r\n        if (movable === undefined) { movable = true; }\r\n        this.mass = mass;\r\n        this.radius = radius;\r\n        this.color = color;\r\n        this.movable = movable;\r\n        \r\n    }\r\n    public get mass() {\r\n        return this._mass;\r\n    }\r\n    public set mass(newMass: number) {\r\n        this._mass = newMass;\r\n    }\r\n    public get radius() {\r\n        return this._radius;\r\n    }\r\n    public set radius(newRadius: number) {\r\n        this._radius = newRadius;\r\n    }\r\n    public get movable() {\r\n        return this._movable;\r\n    }\r\n    public set movable(affected: boolean) {\r\n        this._movable = affected\r\n    }   \r\n    public get color() : string {\r\n        return this._color\r\n    }\r\n    public set color(c: string) {\r\n        if (!(CSS.supports(\"color\", c))) {\r\n            c = \"white\";\r\n        }\r\n        this._color = c;\r\n    } \r\n    //#endregion\r\n}\r\nexport interface ObjectState {\r\n    body: Body2d, \r\n    position: Vector2D,\r\n    /**\r\n     * canvasUnits per second\r\n     */\r\n    velocity: Vector2D,\r\n    acceleration: Vector2D\r\n}\r\nexport class Simulation {\r\n    private _objectStates: ObjectState[];\r\n    public running: boolean;\r\n    public tickCount: number;\r\n    private _tickLength: number;\r\n    private _g: number; //gravitational constant\r\n    constructor() {\r\n        this._objectStates = [];\r\n        this.running = false;\r\n        this.tickCount = 0;\r\n        this._tickLength = 10;\r\n        this._g = 1;\r\n    }\r\n    public get objectStates() {\r\n        return this._objectStates;\r\n    }\r\n    public get tickLength() {\r\n        return this._tickLength;\r\n    }\r\n    public set tickLength(t: number) {\r\n        this._tickLength = t;\r\n    }\r\n    public get g() {\r\n        return this._g;\r\n    }\r\n    public set g(g: number) {\r\n        this._g = Math.max(g, Number.MIN_VALUE);\r\n    }\r\n    /**\r\n     * Calculates the next **position** and **velocity** of the object in state, and updates state accordingly.\r\n     * Does **NOT** update acceleration.\r\n     * @param state *ObjectState* containing the body\r\n     */\r\n    public nextBodyState(objectState: ObjectState) {\r\n        //update velocity based on acceleration: v = v + a * dt\r\n        const dt = this.tickLength / 1000;\r\n        if (!objectState.body.movable) { return; }\r\n        objectState.velocity = Vector2D.add(objectState.velocity, Vector2D.scale(objectState.acceleration, dt));\r\n\r\n        //update position based on velocity: x = x + v * dt\r\n        objectState.position = Vector2D.add( objectState.position, Vector2D.scale(objectState.velocity, dt) );\r\n    }\r\n    public addObject(objectState: ObjectState): number {\r\n        if (!objectState.body.movable) {\r\n            objectState.velocity = new Vector2D(0, 0);\r\n            objectState.acceleration = new Vector2D(0, 0);\r\n        }\r\n        this._objectStates.push(objectState);\r\n        return this._objectStates.length;\r\n    }\r\n    public clearObjects() {\r\n        this._objectStates = [];\r\n    }\r\n    public pause() {\r\n        this.running = false;\r\n    }\r\n    public nextState() {\r\n        //calculate new accelerations vectors and update objectStates accordingly\r\n        this.updateAccelerationVectors();\r\n\r\n        //update position and velocity arising therefrom\r\n        this.objectStates.forEach(objectState => {\r\n            this.nextBodyState(objectState)\r\n        });\r\n        \r\n        this.tickCount++;\r\n    }\r\n    public updateAccelerationVectors() {\r\n        const forces: Map<number, Vector2D> = new Map(); //to keep track of the resulting force (sum of forces) on each body (by each other body) in objectStates[]\r\n        \r\n        //calculate forces on each body\r\n        for (let i = 0; i < this.objectStates.length; i++) {\r\n            for (let j = i+1; j < this.objectStates.length; j++) {\r\n                const forceOnI = this.calculateForceBetweenBodies(i, j);\r\n                const forceOnJ = Vector2D.scale(forceOnI, -1); //force on j = (-1) * (force on i) -- opposite direction\r\n\r\n                //Update the force on both bodies\r\n                forces.set(i, (forces.has(i) ? Vector2D.add(forces.get(i)!, forceOnI) : forceOnI));\r\n                forces.set(j, (forces.has(j) ? Vector2D.add(forces.get(j)!, forceOnJ) : forceOnJ));\r\n            }\r\n        }\r\n\r\n        //update acceleration\r\n        this.objectStates.forEach((objectState, index) => {\r\n            const totalForceOnBody = forces.get(index);\r\n            let newAcceleration = (totalForceOnBody !== undefined) ? (totalForceOnBody) : (new Vector2D(0, 0));\r\n            newAcceleration = Vector2D.scale(newAcceleration, 1 / objectState.body.mass);\r\n            objectState.acceleration = newAcceleration;\r\n        });\r\n    };\r\n    /**\r\n     * Calculates the force-vector between the bodies in objectStates[i] and [j]\r\n     * @returns a vector representing the force applied ***to*** body at objectStates[i]\r\n     */\r\n    public calculateForceBetweenBodies(i: number, j: number): Vector2D {\r\n        const objectStateI = this.objectStates[i];\r\n        const objectStateJ = this.objectStates[j];\r\n\r\n        const distance = Vector2D.distance(objectStateI.position, objectStateJ.position);\r\n        if (distance < 1e-10) { return new Vector2D(0, 0); } //if the bodies are too close, skip the calculation\r\n        const netForceBetweenBodies: number = this.g * ((objectStateI.body.mass * objectStateJ.body.mass)/(distance * distance)); //net force between bodies as scalar\r\n        const unitVectorIToJ = Vector2D.normalize(Vector2D.subtract(objectStateJ.position, objectStateI.position)); //normalized vector from I to J\r\n        return Vector2D.scale(unitVectorIToJ, netForceBetweenBodies); //return force-vector applied to j, which is (unitVector from I to J) multiplied by (netForce)\r\n    }\r\n    /**\r\n     * calculates the force applied to one body in objectStates, resulting from gravity from all other bodies\r\n     * @param i index of the body in this.objectStates\r\n     */\r\n    public calculateForcesForBody(cur: number): Vector2D {\r\n        //soon to be obsolete    \r\n        let totalForce: Vector2D = {x: 0, y: 0};\r\n        const targetBody = this.objectStates[cur];\r\n        for (let i = 0; i < this.objectStates.length; i++) {\r\n            if (i === cur) { continue; }\r\n            const curForceApplyingBody = this.objectStates[i]; //the body whose force on the target is being calculated\r\n            const distance: number = Vector2D.distance(targetBody.position, curForceApplyingBody.position);\r\n            if (distance < 1e-10) { continue; }\r\n            let netForceFromBody: number = this.g * ((targetBody.body.mass * curForceApplyingBody.body.mass)/(distance * distance)); //net force from the body as scalar\r\n            let unitVectorFromApplyingToTargetBody = Vector2D.normalize(Vector2D.subtract(curForceApplyingBody.position, targetBody.position)); //normalized vector from target to applying\r\n            let forceVectorFromBody = Vector2D.scale(unitVectorFromApplyingToTargetBody, netForceFromBody); //net force multiplied by unit vector from the applying body to the target body\r\n            totalForce = Vector2D.add(totalForce, forceVectorFromBody);\r\n        }\r\n        return totalForce; //sum all forces on target body and return resulting force\r\n    }\r\n    public run() {\r\n        if (this.running) {\r\n            return;\r\n        }\r\n        this.running = true;\r\n\r\n        const runSimulationStep = () => {\r\n            if (this.running) {\r\n                this.nextState();\r\n                setTimeout(runSimulationStep, this.tickLength);\r\n\r\n                this.log(\"running simulation step \" + this.tickCount);\r\n            }\r\n        };\r\n        runSimulationStep();\r\n    }\r\n    public log(message: string) {\r\n        const timestamp = new Date();\r\n        const hours = timestamp.getHours().toString().padStart(2, '0');\r\n        const minutes = timestamp.getMinutes().toString().padStart(2, '0');\r\n        const seconds = timestamp.getSeconds().toString().padStart(2, '0');\r\n        const milliseconds = timestamp.getMilliseconds().toString().padStart(3, '0');\r\n    \r\n        const formattedTimestamp = `${hours}:${minutes}:${seconds}.${milliseconds}`;\r\n        console.log(`[${formattedTimestamp}] ${message}`);\r\n    };\r\n}\r\n","import { InferCustomEventPayload } from \"vite\";\r\nimport { Body2d, Simulation } from \"./gravity\";\r\nimport { Vector2D } from \"tcellib-vectors\";\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", initialize);\r\n//let offscreenCanvas: OffscreenCanvas; //use this in a worker thread to render or draw on, then transfer content to the visible html-canvas\r\nlet visibleCanvas: HTMLCanvasElement;\r\n//let offscreenCanvasCtx: OffscreenCanvasRenderingContext2D; //coming soon\r\nlet visibleCanvasCtx: CanvasRenderingContext2D;\r\nlet statusBar1: HTMLElement, statusBar2: HTMLElement, statusBar3: HTMLElement;\r\nlet simState: Simulation;\r\nlet canvasSpace: {xMin: number, xMax: number, yMin: number, yMax: number}\r\nlet frameLength = 25; //ms\r\nlet animationRunning = false; //set to true while the sim is running\r\n//#region page stuff\r\nfunction initialize() {\r\n    statusBar1 = document.getElementById(\"statusText1\")!;\r\n    statusBar2 = document.getElementById(\"statusText2\")!;\r\n    statusBar3 = document.getElementById(\"statusText3\")!;\r\n    registerEvents();\r\n    initCanvas(1280, 720);\r\n    simState = new Simulation();\r\n    document.removeEventListener(\"DOMContentLoaded\", initialize);\r\n}\r\nfunction registerEvents() {\r\n    document.getElementById(\"canvasBtnStartSim\")?.addEventListener(\"click\", startNewSimulation);\r\n    document.getElementById(\"canvasBtnToggleSim\")?.addEventListener(\"click\", toggleSimulation);\r\n}\r\nfunction setStatusMessage(newMessage: string, element?: HTMLElement) {\r\n    if (element === undefined) {\r\n        element = statusBar1;\r\n    }\r\n    element.innerHTML = newMessage;\r\n}\r\nfunction appendStatusMessage(newMessage: string, element?: HTMLElement) {\r\n    if (element === undefined) {\r\n        element = statusBar1;\r\n    }\r\n    element.innerHTML += newMessage;\r\n}\r\nfunction genericTest() {\r\n    setStatusMessage(\"generate an element, add to bodies, draw bodies\");\r\n    let newB = new Body2d(1, 5);\r\n    let newPos: Vector2D = {x: 100, y: 100};\r\n    drawBody(newB, newPos)\r\n}\r\nfunction initCanvas(width: number, height: number) {\r\n    visibleCanvas = (document.getElementById(\"theCanvas\")) as HTMLCanvasElement;\r\n    visibleCanvas.width = width;\r\n    visibleCanvas.height = height;\r\n    visibleCanvasCtx = visibleCanvas.getContext(\"2d\")!;\r\n    appendStatusMessage(` - Canvas dimension: ${width} * ${height}`, statusBar3);\r\n    //offscreenCanvas = new OffscreenCanvas(visibleCanvas.clientWidth, visibleCanvas.clientHeight);\r\n    //offscreenCanvasCtx = offscreenCanvas.getContext(\"2d\")!;\r\n}\r\nfunction log(message: string) {\r\n    const timestamp = new Date();\r\n    const hours = timestamp.getHours().toString().padStart(2, '0');\r\n    const minutes = timestamp.getMinutes().toString().padStart(2, '0');\r\n    const seconds = timestamp.getSeconds().toString().padStart(2, '0');\r\n    const milliseconds = timestamp.getMilliseconds().toString().padStart(3, '0');\r\n\r\n    const formattedTimestamp = `${hours}:${minutes}:${seconds}.${milliseconds}`;\r\n    console.log(`[${formattedTimestamp}] ${message}`);\r\n};\r\n\r\n//#endregion\r\n//#region canvas and drawing stuff\r\nfunction drawVector(position: Vector2D, direction: Vector2D, color?: string) {\r\n    //optionally normalize the direction and scale later\r\n    if (color === undefined) { color = \"white\" }\r\n    let endPosition: Vector2D = Vector2D.add(position, direction);\r\n    visibleCanvasCtx.beginPath();\r\n    visibleCanvasCtx.lineWidth = 3;\r\n    visibleCanvasCtx.strokeStyle = color;\r\n    visibleCanvasCtx.moveTo(position.x, position.y);\r\n    visibleCanvasCtx.lineTo(endPosition.x, endPosition.y);\r\n    visibleCanvasCtx.stroke();\r\n}\r\n/**\r\n * draws a circular body at specified position, in specified color\r\n * @param body \r\n * @param position \r\n * @param color default white\r\n */\r\nfunction drawBody(body: Body2d, position: Vector2D) {\r\n    visibleCanvasCtx.beginPath();\r\n    visibleCanvasCtx.arc(position.x, position.y, body.radius, 0, Math.PI * 2);\r\n    visibleCanvasCtx.closePath();\r\n    visibleCanvasCtx.fillStyle = body.color;\r\n    visibleCanvasCtx.fill();\r\n}\r\nfunction drawBodies() {\r\n    const objects = simState.objectStates;\r\n    objects.forEach(object => {\r\n        if (object !== null) {\r\n            drawBody(object.body, object.position)\r\n        }\r\n    });\r\n}\r\nfunction drawSimulationState() {\r\n    visibleCanvasCtx.clearRect(0, 0, visibleCanvas.width, visibleCanvas.height)\r\n    drawBodies();\r\n    drawVectors();\r\n}\r\nfunction drawVectors() {\r\n    simState.objectStates.forEach(objectState => {\r\n        drawVector(objectState.position, objectState.acceleration, \"green\");\r\n        drawVector(objectState.position, objectState.velocity, \"red\");\r\n    });\r\n}\r\nfunction drawCoordinateSystem() {\r\n\r\n}\r\nfunction simulationSpaceToCanvasSpace(v: Vector2D): Vector2D {\r\n    let canvasVector: Vector2D = {x: 0, y: 0}\r\n\r\n\r\n    return canvasVector;\r\n}\r\n//#endregion\r\n//#region simulation\r\nfunction setupSimulationState() {\r\n    let width = visibleCanvas.width;\r\n    let height = visibleCanvas.height;\r\n    let middle: Vector2D = { x: width / 2, y: height / 2 };\r\n    let zeroV = new Vector2D(0, 0);\r\n\r\n    /* setup one*/\r\n    //let startA: Vector2D = { x: middle.x - 50 , y: middle.y + 50};\r\n    //let startB: Vector2D = { x: middle.x + 50 , y: middle.y - 50};\r\n    //let velA: Vector2D = {x: 40, y: 50 };\r\n    //let velB: Vector2D = {x: -40, y: -50 };\r\n    //addBody(newBody(1000), startA, velA);\r\n    //addBody(newBody(1000), startB, velB);\r\n\r\n    /* setup two */\r\n    //let startA: Vector2D = { x: middle.x - width / 8 , y: middle.y};\r\n    //let startB: Vector2D = { x: middle.x + width / 8 , y: middle.y};\r\n    //addBody(newBody(100000), startA);\r\n    //addBody(newBody(100000), startB);\r\n   \r\n    /* setup three */\r\n    //let startA: Vector2D = { x: 200, y: 100};\r\n    //let startB: Vector2D = { x: 400, y: 100};\r\n    //let startC: Vector2D = { x: 300, y: 200};\r\n    //addBody(newBody(10000), startA);\r\n    //addBody(newBody(10000), startB);\r\n    //addBody(newBody(10000), startC);    \r\n   \r\n    /* setup four */ \r\n    //this is a stable orbit (g = 1, tickLength = 10. ~3300 ticks)  \r\n    let startA: Vector2D = { x: middle.x, y: middle.y};\r\n    let startB: Vector2D = { x: middle.x + 500 , y: middle.y - 50};\r\n    let velA: Vector2D = {x: 0, y: 0 };\r\n    let velB: Vector2D = {x: -110, y: 110 };\r\n    addBody(newBody(10000000, 50), startA, velA, zeroV);\r\n    addBody(newBody(1000), startB, velB);   \r\n    \r\n    /* setup five */ \r\n    //let startA: Vector2D = { x: middle.x, y: middle.y};\r\n    //let startB: Vector2D = { x: middle.x + 500 , y: middle.y - 50};\r\n    //let velA: Vector2D = {x: 0, y: 0 };\r\n    //let velB: Vector2D = {x: -110, y: 110 };\r\n    //addBody(newBody(10000000, 50), startA, velA, zeroV, false);\r\n    //addBody(newBody(10000000, 50), startB, velB);\r\n}\r\nfunction toggleSimulation(this: HTMLElement, ev: MouseEvent) {\r\n    if (simState.running) {\r\n        animationRunning = false;\r\n        simState.pause();\r\n        document.getElementById(\"canvasBtnToggleSim\")!.innerHTML = \"Resume\";\r\n        setStatusMessage(\"Simulation paused\");\r\n    } else {\r\n        document.getElementById(\"canvasBtnToggleSim\")!.innerHTML = \"Pause\";\r\n        resumeSimulation();\r\n        drawRunningSimulation();\r\n        setStatusMessage(\"Simulation running\");\r\n    }\r\n}\r\nfunction addBody(body?: Body2d, position?: Vector2D, velocity?: Vector2D, acceleration?: Vector2D, movable?: boolean) {\r\n    if (body === undefined) {\r\n        body = newBody();\r\n    }\r\n    if (position === undefined) {\r\n        const x = rng(body.radius, visibleCanvas.width - body.radius);\r\n        const y = rng(body.radius, visibleCanvas.height - body.radius);\r\n        position = {x: x, y: y}\r\n    }\r\n    if (velocity === undefined) {\r\n        velocity = {x: 0, y: 0};\r\n    }\r\n    if (acceleration === undefined) {\r\n        acceleration = {x: 0, y: 0};\r\n    }\r\n    const objectState = {body: body, position: position, velocity: velocity, acceleration: acceleration};\r\n\r\n    simState.addObject(objectState);\r\n\r\n}\r\nfunction startNewSimulation() {\r\n    simState.clearObjects();\r\n    simState.tickCount = 0;\r\n    setStatusMessage(\"Simulation running\");\r\n    document.getElementById(\"canvasBtnToggleSim\")!.innerHTML = \"Pause\";\r\n    \r\n    setupSimulationState();\r\n    simState.run();\r\n    drawRunningSimulation();\r\n}\r\nfunction resumeSimulation() {\r\n    if (!simState.running) {\r\n        simState.run();\r\n        drawRunningSimulation();\r\n    }\r\n}\r\nfunction drawRunningSimulation() {\r\n    if (animationRunning) {\r\n        return;\r\n    }\r\n    animationRunning = true;\r\n    const runDrawLoop = () => {\r\n        if (animationRunning) {\r\n            drawSimulationState();\r\n            setStatusMessage(`Simulation Tick: ${simState.tickCount}`, statusBar2);\r\n            setTimeout(runDrawLoop, frameLength);\r\n            //log(\"Draw simulation step\");\r\n        }\r\n    };\r\n    runDrawLoop();\r\n}\r\nfunction newBody(): Body2d \r\nfunction newBody(mass: number, radius: number): Body2d \r\nfunction newBody(mass: number, radius?: number): Body2d \r\nfunction newBody(mass?: number, radius?: number): Body2d {\r\n    let body1: Body2d;\r\n    if (mass === undefined && radius === undefined) {\r\n        body1 = new Body2d(rng(20, 200));    \r\n    } else if (radius === undefined) {\r\n        body1 = new Body2d(mass);\r\n    } \r\n    else {\r\n        body1 = new Body2d(mass, radius);\r\n    }\r\n    return body1;\r\n}\r\n//#endregion\r\n//#region other stuff\r\n/**\r\n * min and max included\r\n * @returns random number\r\n */\r\nfunction rng(min: number, max: number) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min);\r\n}\r\n//#endregion"],"names":["Vector2D","x","y","vectors","previous","current","v1","v2","v","scalar","mag","Body2d","mass","radius","color","movable","__publicField","newMass","newRadius","affected","c","Simulation","g","objectState","dt","forces","i","j","forceOnI","forceOnJ","index","totalForceOnBody","newAcceleration","objectStateI","objectStateJ","distance","netForceBetweenBodies","unitVectorIToJ","cur","totalForce","targetBody","curForceApplyingBody","netForceFromBody","unitVectorFromApplyingToTargetBody","forceVectorFromBody","runSimulationStep","message","timestamp","hours","minutes","seconds","milliseconds","formattedTimestamp","initialize","visibleCanvas","visibleCanvasCtx","statusBar1","statusBar2","statusBar3","simState","frameLength","animationRunning","registerEvents","initCanvas","_a","startNewSimulation","_b","toggleSimulation","setStatusMessage","newMessage","element","appendStatusMessage","width","height","drawVector","position","direction","endPosition","drawBody","body","drawBodies","object","drawSimulationState","drawVectors","setupSimulationState","middle","zeroV","startA","startB","velA","velB","addBody","newBody","ev","resumeSimulation","drawRunningSimulation","velocity","acceleration","rng","runDrawLoop","body1","min","max"],"mappings":"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"}