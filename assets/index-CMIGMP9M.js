var O=Object.defineProperty;var R=(n,t,i)=>t in n?O(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var r=(n,t,i)=>R(n,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();class a{constructor(t,i){r(this,"x");r(this,"y");typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t??0,this.y=i??0)}toString(){return`x: ${this.x}, y: ${this.y}`}add(...t){const i=t.reduce((e,s)=>({x:e.x+s.x,y:e.y+s.y}),{x:this.x,y:this.y});return new a(i.x,i.y)}subtract(t){return new a(this.x-t.x,this.y-t.y)}scale(t){return new a(this.x*t,this.y*t)}dotProduct(t){return this.x*t.x+this.y*t.y}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.magnitude();return t===0?new a(0,0):this.scale(1/t)}distance(t){return Math.sqrt((t.x-this.x)**2+(t.y-this.y)**2)}displacementVector(t){return new a(t.x,t.y).subtract(this)}hadamardProduct(t){return new a(this.x*t.x,this.y*t.y)}normalVectors(){const t=[],i=this.normalize();return t.push(new a(-i.y,i.x)),t.push(new a(i.y,-i.x)),t}reflect(t){t=t.normalize();const i=t.normalVectors()[0],e=this.dotProduct(i),s=i.scale(e).scale(2);return this.subtract(s)}static linesIntersecting(t,i,e=!1){const[s,o]=t,[c,h]=i,l=o.subtract(s),u=h.subtract(c),m=l.x*u.y-l.y*u.x,d=c.subtract(s),v=d.x*l.y-d.y*l.x;if(m===0){if(v===0){if(e){const k=c.subtract(s).dotProduct(l)/l.dotProduct(l),L=h.subtract(s).dotProduct(l)/l.dotProduct(l),y=Math.max(0,Math.min(k,L)),w=Math.min(1,Math.max(k,L));if(y<=w){const S=s.add(l.scale(y)),B=s.add(l.scale(w));return y===w?S:[S,B]}else return null}return[s,o]}return null}const x=(d.x*u.y-d.y*u.x)/m,b=(d.x*l.y-d.y*l.x)/m;return e&&(x<0||x>1||b<0||b>1)?null:s.add(l.scale(x))}static simpleLineIntersection(t,i){throw new Error("Method not implemented.")}static linesIntersectingButBetter(t,i,e=!1,s=1e-9){const[o,c]=t,[h,l]=i,u=c.subtract(o),m=l.subtract(h),d=u.x*m.y-u.y*m.x,v=h.subtract(o),x=v.x*u.y-v.y*u.x,b=y=>Math.abs(y)<s;if(b(d)){if(b(x)){if(e){const y=h.subtract(o).dotProduct(u)/u.dotProduct(u),w=l.subtract(o).dotProduct(u)/u.dotProduct(u),S=Math.max(0,Math.min(y,w)),B=Math.min(1,Math.max(y,w));if(S<=B){const D=o.add(u.scale(S)),Z=o.add(u.scale(B));return b(S-B)?D:[D,Z]}else return null}return[o,c]}return null}const I=(v.x*m.y-v.y*m.x)/d,k=(v.x*u.y-v.y*u.x)/d;return e&&(I<-s||I>1+s||k<-s||k>1+s)?null:o.add(u.scale(I))}}var C=(n=>(n[n.None=0]="None",n[n.AddBody=1]="AddBody",n[n.Scroll=2]="Scroll",n[n.Zoom=3]="Zoom",n))(C||{}),p=(n=>(n[n.Up=0]="Up",n[n.Down=1]="Down",n))(p||{}),f=(n=>(n[n.Main=0]="Main",n[n.Wheel=1]="Wheel",n[n.Secondary=2]="Secondary",n))(f||{});const P=50,U=-10,F=100,g={main:{state:p.Up,downCoordinatesInSimSpace:void 0},secondary:{state:p.Up},wheel:{state:p.Up}},A=class A{constructor(t,i,e,s){r(this,"_mass");r(this,"_radius");r(this,"_color");r(this,"_movable");this._mass=t,s===void 0&&(s=this.defaultRadius(t)),this._radius=s,e===void 0&&(e="white"),this._color=e,i===void 0&&(i=!0),this._movable=i}get mass(){return this._mass}set mass(t){this._mass=t}get radius(){return this._radius}set radius(t){this._radius=t}get movable(){return this._movable}set movable(t){this._movable=t}get color(){return this._color}set color(t){CSS.supports("color",t)||(t="white"),this._color=t}defaultRadius(t){return t===void 0&&(t=this.mass),(3*t/(4*Math.PI*A.defaultDensity))**(1/3)}};r(A,"defaultDensity",1);let _=A;class N{constructor(){r(this,"_simulationState");r(this,"_running");r(this,"_tickCount");r(this,"_tickLength");r(this,"_collisionDetection");r(this,"_elasticCollisions");r(this,"_g");r(this,"gravityLowerBounds",1);this._simulationState=[],this._running=!1,this._tickCount=0,this._tickLength=10,this._collisionDetection=!1,this._elasticCollisions=!1,this._g=P}get simulationState(){return this._simulationState}set simulationState(t){this._simulationState=t}get running(){return this._running}set running(t){this._running=t}get tickCount(){return this._tickCount}set tickCount(t){this._tickCount=t}get tickLength(){return this._tickLength}get collisionDetection(){return this._collisionDetection}set collisionDetection(t){this._collisionDetection=t}get elasticCollisions(){return this._elasticCollisions}set elasticCollisions(t){this._elasticCollisions=t}get g(){return this._g}set g(t){(isNaN(t)||t<U||t>F)&&(t=P),this._g=t}addObject(t,i,e){return t instanceof _&&(t={body:t,position:i,velocity:e,acceleration:new a(0,0)}),t.body.movable||(t.velocity=new a(0,0)),this.simulationState.push(t)}clearObjects(){this.simulationState=[]}removeFromObjectStates(t){this.simulationState.splice(t,1)}pause(){this.running=!1}run(){if(this.running)return;this.running=!0;const t=()=>{this.running&&(setTimeout(t,this.tickLength),this.advanceTick())};t()}reset(){this.clearObjects(),this.tickCount=0}calculateVelocityBetweenPoints(t,i,e=1){return e<=0&&(e=1),(t instanceof a?t:new a(t)).subtract(i).scale(1/e)}advanceTick(){this.updateAccelerationVectors(),this.updateVelocitiesAndPositions(),this.collisionDetection&&this.handleCollisions(),this.tickCount++}updateAccelerationVectors(){const t=this.calculateForces();this.simulationState.forEach((i,e)=>{const o=(t.get(e)||new a(0,0)).scale(1/i.body.mass);i.acceleration=o})}calculateForces(){const t=new Map;for(let i=0;i<this.simulationState.length;i++)for(let e=i+1;e<this.simulationState.length;e++){const s=this.calculateForceBetweenBodies(i,e),o=s.scale(-1);t.set(i,(t.get(i)||new a(0,0)).add(s)),t.set(e,(t.get(e)||new a(0,0)).add(o))}return t}updateVelocityAndPosition(t){const i=this.tickLength/1e3;t.body.movable&&(t.velocity=t.velocity.add(t.acceleration.scale(i)),t.position=t.position.add(t.velocity.scale(i)))}updateVelocitiesAndPositions(){this.simulationState.forEach(t=>{this.updateVelocityAndPosition(t)})}calculateForceBetweenBodies(t,i){const e=this.simulationState[t],s=this.simulationState[i],o=e.position.distance(s.position);if(o<this.gravityLowerBounds||o===0)return new a(0,0);const c=this.g*(e.body.mass*s.body.mass/(o*o));return s.position.subtract(e.position).normalize().scale(c)}handleCollisions(){for(let t=0;t<this.simulationState.length;t++){const i=this.simulationState[t];if(i!==void 0)for(let e=t+1;e<this.simulationState.length;e++){const s=this.simulationState[e],o=i.position.distance(s.position);o<=i.body.radius+s.body.radius&&(o<=i.body.radius||o<=s.body.radius?this.mergeBodies(t,e):this.elasticCollisions&&this.elasticCollision(i,s))}}}mergeBodies(t,i){const e=this.simulationState[t],s=this.simulationState[i],o=e.velocity.scale(e.body.mass).add(s.velocity.scale(s.body.mass)),c=e.body.mass+s.body.mass,h=o.scale(1/c);let l,u;s.body.mass>e.body.mass?(l=s,u=t):(l=e,u=i),l.velocity=h,l.body.mass=c,l.body.radius=l.body.defaultRadius(),l.body.movable=e.body.movable&&s.body.movable,l.body.movable||(l.velocity=new a(0,0)),this.removeFromObjectStates(u)}elasticCollision(t,i,e=1){const o=t.position.displacementVector(i.position),c=o.magnitude();if(c<=1||c===0)return;const h=o.scale(1/c),u=i.velocity.subtract(t.velocity).dotProduct(h);if(u>0)return;const m=-(1+e)*u/(t.body.mass+i.body.mass),d=h.scale(m*i.body.mass),v=h.scale(m*t.body.mass);t.velocity=t.velocity.subtract(d),i.velocity=i.velocity.add(v),t.body.movable||(t.velocity=new a(0,0),i.velocity=i.velocity.add(d)),i.body.movable||(i.velocity=new a(0,0),t.velocity=t.velocity.add(v))}placeBodiesTangentially(t,i){const e=t.position.displacementVector(i.position),s=e.normalize(),o=t.body.radius+i.body.radius,c=o-e.magnitude();if(o===0)return;const h=s.scale(c*(t.body.radius/o)),l=s.scale(c*(i.body.radius/o));t.position=t.position.subtract(h),i.position=i.position.add(l)}}function G(n){return n=n.trim(),!isNaN(+n)&&n.length!==0}function M(n,t,i){return n>=t&&n<=i}function q(n){let t;return typeof n=="string"?t=document.getElementById(n):t=n,t.value.trim()}function T(n){const t=q(n);return G(t)?+t:0}function E(n){return{x:n.clientX,y:n.clientY}}class W{constructor(t){r(this,"statusBar");r(this,"resetButton");r(this,"playPauseButton");r(this,"stepButton");r(this,"repositoryLink");r(this,"zoomInButton");r(this,"zoomOutButton");r(this,"scrollUpButton");r(this,"scrollDownButton");r(this,"scrollLeftButton");r(this,"scrollRightButton");r(this,"displayVectorsCheckbox");r(this,"collisionDetectionCheckbox");r(this,"elasticCollisionsCheckbox");r(this,"gravitationalConstantInput");r(this,"gravitationalConstantRangeInput");r(this,"clickAction");r(this,"massInput");r(this,"addBodyMovable");this.app=t,this.resetButton=document.getElementById("btnResetSim"),this.playPauseButton=document.getElementById("btnToggleSim"),this.stepButton=document.getElementById("btnNextStep"),this.repositoryLink=document.getElementById("repoLink"),this.zoomInButton=document.getElementById("btnZoomIn"),this.zoomOutButton=document.getElementById("btnZoomOut"),this.scrollUpButton=document.getElementById("btnScrollUp"),this.scrollDownButton=document.getElementById("btnScrollDown"),this.scrollLeftButton=document.getElementById("btnScrollLeft"),this.scrollRightButton=document.getElementById("btnScrollRight"),this.displayVectorsCheckbox=document.getElementById("cbxDisplayVectors"),this.collisionDetectionCheckbox=document.getElementById("cbxCollisions"),this.elasticCollisionsCheckbox=document.getElementById("cbxElasticCollisions"),this.gravitationalConstantInput=document.getElementById("numberG"),this.gravitationalConstantRangeInput=document.getElementById("rangeG"),this.massInput=document.getElementById("massInput"),this.addBodyMovable=document.getElementById("cbxBodyMovable"),this.clickAction={name:"radioBtnMouseAction",buttons:Array.from(document.querySelectorAll('input[name="radioBtnMouseAction"]'))},this.statusBar=(()=>{const i=document.getElementById("statusBar");return{bar:i,fields:Array.from(i.querySelectorAll(".statusBarItem"))}})(),this.registerEvents()}initialize(){this.elasticCollisionsCheckbox.disabled=!this.collisionDetectionCheckbox.checked,this.massInput.step=this.calculateMassInputStep(),this.displayVectorsCheckbox.checked?this.setStatusMessage("Green: acceleration - Red: velocity",3):this.setStatusMessage("",3),this.setStatusMessage(`Canvas dimension: ${this.app.gravityAnimationController.width} * ${this.app.gravityAnimationController.height}`,5),this.app.setG(Number(this.gravitationalConstantRangeInput.value))}registerEvents(){this.resetButton.addEventListener("click",()=>this.app.reset()),this.playPauseButton.addEventListener("click",()=>this.app.toggleSimulation()),this.stepButton.addEventListener("click",()=>this.app.advanceOneTick()),this.zoomInButton.addEventListener("click",()=>this.app.zoomIn()),this.zoomOutButton.addEventListener("click",()=>this.app.zoomOut()),this.scrollUpButton.addEventListener("click",()=>this.app.scrollViewUp()),this.scrollDownButton.addEventListener("click",()=>this.app.scrollViewDown()),this.scrollLeftButton.addEventListener("click",()=>this.app.scrollViewLeft()),this.scrollRightButton.addEventListener("click",()=>this.app.scrollViewRight()),this.displayVectorsCheckbox.addEventListener("change",()=>this.cbxDisplayVectorsChanged()),this.collisionDetectionCheckbox.addEventListener("change",()=>this.cbxCollisionsChanged()),this.elasticCollisionsCheckbox.addEventListener("change",()=>this.cbxElasticCollisionsChanged()),this.gravitationalConstantInput.addEventListener("change",()=>this.numberInputGChanged()),this.gravitationalConstantRangeInput.addEventListener("change",()=>this.rangeInputGChanged()),this.massInput.addEventListener("change",()=>this.updateSelectedMass())}cbxDisplayVectorsChanged(){const t=this.displayVectorsCheckbox.checked;this.app.setDisplayVectors(t),t?this.setStatusMessage("Green: acceleration - Red: velocity",3):this.setStatusMessage("",3)}cbxCollisionsChanged(){const t=this.collisionDetectionCheckbox.checked,i=this.elasticCollisionsCheckbox.checked;this.elasticCollisionsCheckbox.disabled=!t,this.app.setCollisionDetection(t,i)}cbxElasticCollisionsChanged(){this.app.setElasticCollisions(this.elasticCollisionsCheckbox.checked)}numberInputGChanged(){const t=this.gravitationalConstantInput.value;this.gravitationalConstantRangeInput.value=t,this.app.setG(Number(t))}rangeInputGChanged(){const t=this.gravitationalConstantRangeInput.value;this.gravitationalConstantInput.value=t,this.app.setG(Number(t))}simulationStopped(){this.playPauseButton.innerHTML="&#9654;",this.stepButton.disabled=!1}simulationResumed(){this.playPauseButton.innerHTML="&#10074;&#10074;",this.stepButton.disabled=!0,this.app.updateSimulationStatusMessages()}updateStatusBarZoom(){const t=this.app.gravityAnimationController.zoom;this.setStatusMessage(`Zoom: ${t} (m per pixel)`,4)}getSelectedClickAction(){return this.getSelectedValue(this.clickAction)??this.clickAction.buttons[0].value}getSelectedValue(t){const i=t.buttons.find(e=>e.checked);return(i==null?void 0:i.value)??null}body2dFromInputs(){const t=this.addBodyMovable.checked;return new _(T(this.massInput),t)}updateSelectedMass(){this.massInput.step=this.calculateMassInputStep()}calculateMassInputStep(){let t=10**(Math.floor(Math.log10(T(this.massInput)))-1);return t<1?"1":t.toString()}setStatusMessage(t,i,e=!1){let s;typeof i=="number"?s=this.statusBar.fields[i-1]:typeof i=="string"?s=document.getElementById(i):s=this.statusBar.fields[0],e?s.innerHTML+=t:s.innerHTML=t}}class ${constructor(t){r(this,"_visibleCanvas");r(this,"_visibleCanvasContext");r(this,"_canvasSpace");r(this,"_running",!1);this._visibleCanvas=t,this._visibleCanvasContext=t.getContext("2d"),this._canvasSpace={origin:new a(0,0),currentZoom:1,orientationY:-1}}get visibleCanvas(){return this._visibleCanvas}set visibleCanvas(t){this._visibleCanvas=t}get visibleCanvasContext(){return this._visibleCanvasContext}set visibleCanvasContext(t){this._visibleCanvasContext=t}get canvasSpace(){return this._canvasSpace}set canvasSpace(t){this._canvasSpace=t}get running(){return this._running}set running(t){this._running=t}get currentZoom(){return this.canvasSpace.currentZoom}resize(t,i){this.visibleCanvas.width=t,this.visibleCanvas.height=i}drawVector(t,i,e="white"){let s=t.add(i);this.isLineVisible(t,s)&&(this.visibleCanvasContext.beginPath(),this.visibleCanvasContext.lineWidth=3,this.visibleCanvasContext.strokeStyle=e,this.visibleCanvasContext.moveTo(t.x,t.y),this.visibleCanvasContext.lineTo(s.x,s.y),this.visibleCanvasContext.stroke())}drawVectors(t){t.forEach(i=>{this.drawVector(this.pointFromSimulationSpaceToCanvasSpace(i.position),this.directionFromSimulationSpaceToCanvasSpace(i.acceleration),"green"),this.drawVector(this.pointFromSimulationSpaceToCanvasSpace(i.position),this.directionFromSimulationSpaceToCanvasSpace(i.velocity),"red")})}drawBody(t,i){let e=Math.max(t.radius/this.currentZoom,1);this.isCircleVisible(i,e)&&(this.visibleCanvasContext.beginPath(),this.visibleCanvasContext.arc(i.x,i.y,e,0,Math.PI*2),this.visibleCanvasContext.closePath(),this.visibleCanvasContext.fillStyle=t.color,this.visibleCanvasContext.fill())}drawBodies(t){t.forEach(i=>{this.drawBody(i.body,this.pointFromSimulationSpaceToCanvasSpace(i.position))})}redrawSimulationState(t,i){this.visibleCanvasContext.clearRect(0,0,this.visibleCanvas.width,this.visibleCanvas.height),this.drawBodies(t),i&&this.drawVectors(t)}isCircleVisible(t,i){const e=t.x+i>=0,s=t.x-i<=this.visibleCanvas.width,o=t.y+i>=0,c=t.y-i<=this.visibleCanvas.height;return e&&s&&o&&c}isLineVisible(t,i){return!!(M(t.x,0,this.visibleCanvas.width)&&M(t.y,0,this.visibleCanvas.height)||M(i.x,0,this.visibleCanvas.width)&&M(i.y,0,this.visibleCanvas.height)||a.linesIntersecting([t,i],[new a(0,0),new a(this.visibleCanvas.width,0)],!0)||a.linesIntersecting([t,i],[new a(this.visibleCanvas.width,0),new a(this.visibleCanvas.width,this.visibleCanvas.height)],!0)||a.linesIntersecting([t,i],[new a(this.visibleCanvas.width,this.visibleCanvas.height),new a(0,this.visibleCanvas.height)],!0)||a.linesIntersecting([t,i],[new a(0,this.visibleCanvas.height),new a(0,0)],!0))}setOrigin(t){this.canvasSpace.origin=t}moveOrigin(t){const e=this.canvasSpace.origin.add(t);this.setOrigin(e)}scrollRight(t){this.moveOrigin(new a(t,0))}scrollLeft(t){this.moveOrigin(new a(-t,0))}scrollUp(t){this.moveOrigin(new a(0,t))}scrollDown(t){this.moveOrigin(new a(0,-t))}zoomOut(t,i){const e=t.scale(i),s=this.currentZoom+i;return this.moveOrigin(e.hadamardProduct({x:-1,y:1})),this.canvasSpace.currentZoom=s,s}zoomIn(t,i){if(this.currentZoom<=1)return this.currentZoom;let e=this.canvasSpace.currentZoom-i;e<1&&(e=1,i=this.canvasSpace.currentZoom-1);const s=t.scale(i);return this.moveOrigin(s.hadamardProduct({x:1,y:-1})),this.canvasSpace.currentZoom=e,e}pointFromSimulationSpaceToCanvasSpace(t){const i=t.subtract(this.canvasSpace.origin);return new a(i.x,i.y*-1).scale(1/this.currentZoom)}directionFromSimulationSpaceToCanvasSpace(t){return new a(t.x,t.y*-1).scale(1/this.currentZoom)}}class H{constructor(t,i="theCanvas"){r(this,"_canvas");r(this,"_simulation");r(this,"_animationSettings");r(this,"_running");r(this,"activePointers",new Map);r(this,"touchAction",C.None);this.app=t,this._canvas=new $(document.getElementById(i)),this._simulation=new N,this._animationSettings={defaultScrollRate:.1,defaultZoomStep:1,frameLength:25,displayVectors:!0,tracePaths:!0},this._running=!1,this.canvas.visibleCanvas.addEventListener("pointerdown",e=>this.canvasPointerDown(e)),this.canvas.visibleCanvas.addEventListener("pointerup",e=>this.canvasPointerUp(e)),this.canvas.visibleCanvas.addEventListener("pointermove",e=>this.canvasPointerMoving(e)),this.canvas.visibleCanvas.addEventListener("pointercancel",e=>this.cancelPointer(e)),this.canvas.visibleCanvas.addEventListener("wheel",e=>this.canvasMouseWheel(e)),this.canvas.visibleCanvas.addEventListener("contextmenu",e=>{e.preventDefault()})}get canvas(){return this._canvas}set canvas(t){this._canvas=t}get simulation(){return this._simulation}set simulation(t){this._simulation=t}get animationSettings(){return this._animationSettings}set animationSettings(t){this._animationSettings=t}get running(){return this._running}set running(t){this._running=t}get tickCount(){return this.simulation.tickCount}get bodyCount(){return this.simulation.simulationState.length}get width(){return this.canvas.visibleCanvas.width}get height(){return this.canvas.visibleCanvas.height}get zoom(){return this.canvas.currentZoom}initialize(t,i){this.initCanvas(t,i),this.initSimulation()}initCanvas(t,i){this.canvas.visibleCanvas.width=t,this.canvas.visibleCanvas.height=i,this.animationSettings.displayVectors=this.app.ui.displayVectorsCheckbox.checked}initSimulation(){this.simulation.collisionDetection=this.app.ui.collisionDetectionCheckbox.checked,this.simulation.elasticCollisions=this.app.ui.elasticCollisionsCheckbox.checked}canvasPointerDown(t){const i=new a(E(t));switch(t.pointerType){case"mouse":switch(t.button){case f.Main:g.main.state=p.Down,this.app.canvasMainMouseDown(i);break;case f.Wheel:g.wheel.state=p.Down,t.preventDefault();break;case f.Secondary:g.secondary.state=p.Down;break}break;case"touch":this.activePointers.set(t.pointerId,t);break;case"pen":break;default:console.log("unknown pointerType: "+t.pointerType);break}}canvasPointerUp(t){const i=new a(E(t));switch(t.pointerType){case"mouse":switch(t.button){case f.Main:g.main.state=p.Up,this.app.canvasMainMouseUp(i);break;case f.Wheel:g.wheel.state=p.Up,t.preventDefault();break;case f.Secondary:g.secondary.state=p.Up,t.preventDefault();break}break;case"touch":if(!this.activePointers.has(t.pointerId))return;this.activePointers.delete(t.pointerId);break;case"pen":break;default:console.log("unknown pointerType: "+t.pointerType);break}}canvasPointerMoving(t){switch(t.pointerType){case"mouse":if(g.wheel.state===p.Down){const i=new a(t.movementX,t.movementY);this.app.scrollCanvas(i)}break;case"touch":break;case"pen":break;default:console.log("unknown pointerType");break}}cancelPointer(t){this.activePointers.delete(t.pointerId)}canvasMouseWheel(t){t.preventDefault();const i=new a(E(t)),e=this.app.absoluteToCanvasPosition(i);t.deltaY<0?this.zoomIn(e):t.deltaY>0&&this.zoomOut(e)}run(){this.runSimulation(),this.runAnimation()}stop(){this.running=!1,this.simulation.pause()}toggle(){this.running?this.stop():this.run()}reset(){this.simulation.reset(),this.redrawSimulation()}runSimulation(){this.running||this.simulation.run()}runAnimation(){if(this.running)return;this.running=!0;const t=()=>{this.running&&(setTimeout(t,this.animationSettings.frameLength),this.redrawSimulation(),this.app.updateSimulationStatusMessages())};t()}advanceOneTick(){this.running||(this.simulation.advanceTick(),this.redrawSimulation())}redrawSimulation(){this.canvas.redrawSimulationState(this.simulation.simulationState,this.animationSettings.displayVectors)}addBody(t,i,e=new a(0,0)){this.simulation.addObject(t,i,e),this.redrawSimulation()}setG(t){this.simulation.g=t}setDisplayVectors(t){this.animationSettings.displayVectors=t,this.running||this.redrawSimulation()}resizeCanvas(t,i){this.canvas.resize(t,i),this.redrawSimulation()}zoomOut(t,i){t===void 0&&(t=new a(this.canvas.visibleCanvas.width/2,this.canvas.visibleCanvas.height/2)),i===void 0&&(i=this.animationSettings.defaultZoomStep);const e=this.canvas.zoomOut(t,i);return this.redrawSimulation(),this.app.updateZoomStatusMessage(),e}zoomIn(t,i){t===void 0&&(t=new a(this.width/2,this.height/2)),i===void 0&&(i=this.animationSettings.defaultZoomStep);const e=this.canvas.zoomIn(t,i);return this.redrawSimulation(),this.app.updateZoomStatusMessage(),e}setCanvasView(t,i){}scrollView(t){this.canvas.moveOrigin(t),this.redrawSimulation()}canvasScrollRight(t){t===void 0&&(t=this.defaultScrollDistance("horizontal")),this.canvas.scrollRight(t),this.redrawSimulation()}canvasScrollLeft(t){t===void 0&&(t=this.defaultScrollDistance("horizontal")),this.canvas.scrollLeft(t),this.redrawSimulation()}canvasScrollUp(t){t===void 0&&(t=this.defaultScrollDistance("vertical")),this.canvas.scrollUp(t),this.redrawSimulation()}canvasScrollDown(t){t===void 0&&(t=this.defaultScrollDistance("vertical")),this.canvas.scrollDown(t),this.redrawSimulation()}defaultScrollDistance(t,i){switch(i===void 0&&(i=this.animationSettings.defaultScrollRate),t){case"horizontal":return this.canvas.visibleCanvas.width*i*this.zoom;case"vertical":return this.canvas.visibleCanvas.height*i*this.zoom}}pointFromCanvasSpaceToSimulationSpace(t){return t.scale(this.canvas.currentZoom).hadamardProduct(new a(1,this.canvas.canvasSpace.orientationY)).add(this.canvas.canvasSpace.origin)}}class J{constructor(){r(this,"_ui");r(this,"_gravityAnimationController");this._gravityAnimationController=new H(this),this._ui=new W(this),this.initialize()}get gravityAnimationController(){return this._gravityAnimationController}set gravityAnimationController(t){this._gravityAnimationController=t}get ui(){return this._ui}get running(){return this.gravityAnimationController.running}initialize(){this.gravityAnimationController.initialize(window.innerWidth,window.innerHeight),this.ui.initialize()}run(){this.gravityAnimationController.run(),this.ui.simulationResumed()}stop(){this.gravityAnimationController.stop(),this.ui.simulationStopped()}toggleSimulation(){this.running?this.stop():this.run()}advanceOneTick(){this.gravityAnimationController.advanceOneTick(),this.updateSimulationStatusMessages()}reset(){this.gravityAnimationController.reset(),this.updateSimulationStatusMessages()}updateSimulationStatusMessages(){this.ui.setStatusMessage(`Simulation Tick: ${this.gravityAnimationController.tickCount}`,2),this.ui.setStatusMessage(`Number of Bodies: ${this.gravityAnimationController.bodyCount}`,1)}updateZoomStatusMessage(){this.ui.updateStatusBarZoom()}redraw(){this.running||this.gravityAnimationController.redrawSimulation()}absoluteToCanvasPosition(t){const i=this.gravityAnimationController.canvas.visibleCanvas.getBoundingClientRect(),e=t.x-i.left,s=t.y-i.top;return new a(e,s)}scrollViewRight(t){this.gravityAnimationController.canvasScrollRight(t)}scrollViewLeft(t){this.gravityAnimationController.canvasScrollLeft(t)}scrollViewUp(t){this.gravityAnimationController.canvasScrollUp(t)}scrollViewDown(t){this.gravityAnimationController.canvasScrollDown(t)}setG(t){this.gravityAnimationController.setG(t)}zoomOut(t,i){return this.gravityAnimationController.zoomOut(t,i)}zoomIn(t,i){return this.gravityAnimationController.zoomIn(t,i)}resizeCanvas(t,i){this.gravityAnimationController.resizeCanvas(t,i),this.ui.setStatusMessage(`Canvas dimension: ${t} * ${i}`,5)}setCollisionDetection(t,i=!1){this.gravityAnimationController.simulation.collisionDetection=t,this.gravityAnimationController.simulation.elasticCollisions=i}setElasticCollisions(t){this.gravityAnimationController.simulation.elasticCollisions=t}setDisplayVectors(t){this.gravityAnimationController.setDisplayVectors(t)}scrollCanvas(t){const i=t.scale(this.gravityAnimationController.zoom);this.gravityAnimationController.scrollView({x:-i.x,y:i.y})}canvasMainMouseDown(t){switch(C[this.ui.getSelectedClickAction()]){case C.None:break;case C.AddBody:const i=new a(t.x,t.y),e=this.gravityAnimationController.pointFromCanvasSpaceToSimulationSpace(i);g.main.downCoordinatesInSimSpace=e;break}}canvasMainMouseUp(t){switch(C[this.ui.getSelectedClickAction()]){case C.None:break;case C.AddBody:const i=this.ui.body2dFromInputs();if(i.mass<=0)break;const e=new a(t.x,t.y),s=this.absoluteToCanvasPosition(e),o=this.gravityAnimationController.pointFromCanvasSpaceToSimulationSpace(s),c=this.gravityAnimationController.simulation.calculateVelocityBetweenPoints(g.main.downCoordinatesInSimSpace,o);this.gravityAnimationController.addBody(i,o,c),this.ui.setStatusMessage(`Number of Bodies: ${this.gravityAnimationController.simulation.simulationState.length}`,1);break}this.redraw()}}let V;document.addEventListener("DOMContentLoaded",z);function z(){V=new J,Y(),V.run()}function Y(){document.removeEventListener("DOMContentLoaded",z),window.addEventListener("resize",X)}function X(n){let t=this.innerWidth,i=this.innerHeight;V.resizeCanvas(t,i)}
//# sourceMappingURL=index-CMIGMP9M.js.map
