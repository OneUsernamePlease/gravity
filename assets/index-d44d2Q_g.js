var ot=Object.defineProperty;var it=(e,t,n)=>t in e?ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var u=(e,t,n)=>it(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();class s{constructor(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.x=t,this.y=n}toString(){return`x: ${this.x}, y: ${this.y}`}static add(...t){return t.reduce((n,o)=>({x:n.x+o.x,y:n.y+o.y}),{x:0,y:0})}static subtract(t,n){return{x:t.x-n.x,y:t.y-n.y}}static scale(t,n){return{x:t.x*n,y:t.y*n}}static dotProduct(t,n){return t.x*n.x+t.y*n.y}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static normalize(t){const n=this.magnitude(t);return n===0?{x:0,y:0}:this.scale(t,1/n)}static distance(t,n){return Math.sqrt((n.x-t.x)**2+(n.y-t.y)**2)}static displacementVector(t,n){return this.subtract(n,t)}static hadamardProduct(t,n){return{x:t.x*n.x,y:t.y*n.y}}}const E=class E{constructor(t,n,o,i){u(this,"_mass");u(this,"_radius");u(this,"_color");u(this,"_movable");i===void 0&&(i=(3*t/(4*Math.PI*E.defaultDensity))**(1/3)),o===void 0&&(o="white"),n===void 0&&(n=!0),this.mass=t,this.radius=i,this.color=o,this.movable=n}get mass(){return this._mass}set mass(t){this._mass=t}get radius(){return this._radius}set radius(t){this._radius=t}get movable(){return this._movable}set movable(t){this._movable=t}get color(){return this._color}set color(t){CSS.supports("color",t)||(t="white"),this._color=t}};u(E,"defaultDensity",1);let v=E;class st{constructor(){u(this,"_objectStates");u(this,"_running");u(this,"_tickCount");u(this,"_tickLength");u(this,"_collisionDetection");u(this,"_g");u(this,"gravityLowerBounds",1);this._objectStates=[],this._running=!1,this._tickCount=0,this._tickLength=10,this._collisionDetection=!1,this._g=100}get objectStates(){return this._objectStates}set objectStates(t){this._objectStates=t}get running(){return this._running}set running(t){this._running=t}get tickCount(){return this._tickCount}set tickCount(t){this._tickCount=t}get tickLength(){return this._tickLength}set tickLength(t){this._tickLength=t}get collisionDetection(){return this._collisionDetection}set collisionDetection(t){this._collisionDetection=t}get g(){return this._g}set g(t){this._g=Math.max(t,Number.MIN_VALUE)}addObject(t){return t.body.movable||(t.velocity=new s(0,0),t.acceleration=new s(0,0)),this.objectStates.push(t),this.objectStates.length}clearObjects(){this.objectStates=[]}pause(){this.running=!1}nextState(){this.updateAccelerationVectors(),this.objectStates.forEach(t=>{this.updateVelocityAndPosition(t)}),this.tickCount++}updateAccelerationVectors(){const t=new Map;for(let n=0;n<this.objectStates.length;n++)for(let o=n+1;o<this.objectStates.length;o++){const i=this.calculateForceBetweenBodies(n,o),r=s.scale(i,-1);t.set(n,s.add(t.get(n)||new s(0,0),i)),t.set(o,s.add(t.get(o)||new s(0,0),r))}this.objectStates.forEach((n,o)=>{const i=t.get(o);let r=i!==void 0?i:new s(0,0);r=s.scale(r,1/n.body.mass),n.acceleration=r})}updateVelocityAndPosition(t){const n=this.tickLength/1e3;t.body.movable&&(t.velocity=s.add(t.velocity,s.scale(t.acceleration,n)),t.position=s.add(t.position,s.scale(t.velocity,n)))}calculateForceBetweenBodies(t,n){const o=this.objectStates[t],i=this.objectStates[n],r=s.distance(o.position,i.position);if(r<this.gravityLowerBounds||r===0)return new s(0,0);const m=this.g*(o.body.mass*i.body.mass/(r*r)),B=s.normalize(s.subtract(i.position,o.position));return s.scale(B,m)}run(){if(this.running)return;this.running=!0;const t=()=>{this.running&&(setTimeout(t,this.tickLength),this.nextState())};t()}}function Y(e){return e=e.trim(),!isNaN(+e)&&e.length!==0}function ct(e){let t=document.getElementById(e);return t instanceof HTMLInputElement?t.value.trim():""}function rt(e){let t=ct(e);return Y(t)?+t:0}function J(e){const t=document.getElementById(e);return t?t.checked:!1}var x=(e=>(e[e.None=0]="None",e[e.AddBody=1]="AddBody",e[e.ScrollCvs=2]="ScrollCvs",e))(x||{}),L=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e))(L||{});let a,d,_={fields:[]},l,c,at=25,g=!1,b=1,lt=.1,I,T,h=0,k=new s(0,0),S;document.addEventListener("DOMContentLoaded",X);function X(){bt(),ut(),wt(1280,720),c={origin:{x:0,y:0},zoomFactor:1,orientationY:-1},T=J("cbxDisplayVectors"),I=rt("massInput"),document.getElementById("massInput").step=K(),l=new st,S=document.querySelector('input[name="cvsRadioBtnMouseAction"]:checked').value,document.removeEventListener("DOMContentLoaded",X)}function ut(){var e,t,n,o,i,r,m,B,O,V,F,$,R,j,N,A,U;(e=document.getElementById("cvsBtnStartSim"))==null||e.addEventListener("click",Ht),(t=document.getElementById("cvsBtnToggleSim"))==null||t.addEventListener("click",zt),(n=document.getElementById("cvsBtnResetSim"))==null||n.addEventListener("click",Q),(o=document.getElementById("cvsBtnZoomOut"))==null||o.addEventListener("click",Pt),(i=document.getElementById("cvsBtnZoomIn"))==null||i.addEventListener("click",Dt),(r=document.getElementById("cvsBtnScrollLeft"))==null||r.addEventListener("click",Mt),(m=document.getElementById("cvsBtnScrollRight"))==null||m.addEventListener("click",kt),(B=document.getElementById("cvsBtnScrollUp"))==null||B.addEventListener("click",Ct),(O=document.getElementById("cvsBtnScrollDown"))==null||O.addEventListener("click",_t),(V=document.getElementById("theCanvas"))==null||V.addEventListener("mousedown",yt),(F=document.getElementById("theCanvas"))==null||F.addEventListener("mouseup",vt),($=document.getElementById("theCanvas"))==null||$.addEventListener("mouseout",St),(R=document.getElementById("theCanvas"))==null||R.addEventListener("mousemove",pt),(j=document.getElementById("theCanvas"))==null||j.addEventListener("touchstart",ht),(N=document.getElementById("theCanvas"))==null||N.addEventListener("touchend",ft),(A=document.getElementById("massInput"))==null||A.addEventListener("change",dt),(U=document.getElementById("cbxDisplayVectors"))==null||U.addEventListener("change",mt),document.querySelectorAll('input[name="cvsRadioBtnMouseAction"]').forEach(nt=>{nt.addEventListener("change",gt)})}function dt(){const e=this,t=e.value;I=Y(t)?+t:0,e.step=K()}function mt(e){const t=e.target;T=t?t.checked:!1,g||y()}function gt(e){const t=e.target;t&&t.type==="radio"&&(S=t.value)}function ht(e){h=1;const t=xt(e);switch(x[S]){case 0:console.log(t.toString());break;case 1:e.preventDefault(),k=t;break}}function ft(e){h=0;const t=Bt(e);switch(x[S]){case 0:break;case 1:const n=W();if(n.mass<=0)break;const o=G(p(k),p(t));w(n,p(t),o);break}g||y()}function yt(e){if(e.button!==0)return;h=1;const t=z(e);switch(H("canvasMouseDownHandler:"+L[h]+" - at Position: "+t.toString()),x[S]){case 0:break;case 1:k=t;break}}function vt(e){if(e.button!==0||h===0)return;h=0;const t=z(e);switch(H("canvasMouseUpHandler:"+L[h]+" - at Position: "+t.toString()),x[S]){case 0:break;case 1:const n=W();if(n.mass<=0)break;const o=G(p(k),p(t));w(n,p(t),o);break}g||y()}function pt(e){const t=z(e);H("canvasMouseMoveHandler:"+L[h]+" - at Position: "+t.toString())}function St(e){h=0}function z(e){const t=a.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;return new s(n,o)}function xt(e){const t=a.getBoundingClientRect(),n=e.touches[0];return new s(n.clientX-t.left,n.clientY-t.top)}function Bt(e){const t=a.getBoundingClientRect(),n=e.changedTouches[0];return new s(n.clientX-t.left,n.clientY-t.top)}function K(){let e=10**(Math.floor(Math.log10(I))-1);return e<1?"1":e.toString()}function bt(){const e="statusText";let t=1,n=document.getElementById(e+t);for(;n!==null;)_.fields.push(n),t++,n=document.getElementById(e+t)}function W(){const e=J("cvsCbxBodyMovable");return new v(I,e)}function f(e,t,n=!1){let o;typeof t=="number"?o=_.fields[t-1]:typeof t=="string"?o=document.getElementById(t):o=_.fields[0],n?o.innerHTML+=e:o.innerHTML=e}function wt(e,t){a=document.getElementById("theCanvas"),a.width=e,a.height=t,d=a.getContext("2d"),f(`Canvas dimension: ${e} * ${t}`,5)}function H(e){const t=new Date,n=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),i=t.getSeconds().toString().padStart(2,"0"),r=t.getMilliseconds().toString().padStart(3,"0"),m=`${n}:${o}:${i}.${r}`;console.log(`[${m}] ${e}`)}function Z(e,t,n){n===void 0&&(n="white");let o=s.add(e,t);d.beginPath(),d.lineWidth=3,d.strokeStyle=n,d.moveTo(e.x,e.y),d.lineTo(o.x,o.y),d.stroke()}function Et(e,t){let n=Math.max(e.radius/c.zoomFactor,1);d.beginPath(),d.arc(t.x,t.y,n,0,Math.PI*2),d.closePath(),d.fillStyle=e.color,d.fill()}function Lt(){l.objectStates.forEach(t=>{t!==null&&Et(t.body,P(t.position))})}function y(){d.clearRect(0,0,a.width,a.height),Lt(),T&&It()}function It(){l.objectStates.forEach(e=>{Z(P(e.position),q(e.acceleration),"green"),Z(P(e.position),q(e.velocity),"red")})}function P(e){const t=s.subtract(e,c.origin),n={x:t.x,y:t.y*-1};return s.scale(n,1/c.zoomFactor)}function q(e){const t={x:e.x,y:e.y*-1};return s.scale(t,1/c.zoomFactor)}function p(e){let t;return t=s.add(s.hadamardProduct(s.scale(e,c.zoomFactor),{x:1,y:c.orientationY}),c.origin),t}function M(e){c.origin=e,g||y()}function kt(){let e=C("horizontal");M({x:c.origin.x+e,y:c.origin.y})}function Mt(){let e=C("horizontal");M({x:c.origin.x-e,y:c.origin.y})}function Ct(){let e=C("vertical");M({x:c.origin.x,y:c.origin.y+e})}function _t(){let e=C("vertical");M({x:c.origin.x,y:c.origin.y-e})}function C(e,t){switch(t===void 0&&(t=lt),e){case"horizontal":return a.width*t*c.zoomFactor;case"vertical":return a.height*t*c.zoomFactor}}function Pt(){const e={x:a.width/2,y:a.height/2},t=c.zoomFactor+b;let n=s.scale(e,b);c.origin={x:c.origin.x-n.x,y:c.origin.y+n.y},c.zoomFactor=t,f(`Zoom: ${t} (m per pixel)`,4),g||y()}function Dt(){if(c.zoomFactor<=1)return;let e={x:a.width/2,y:a.height/2},t=c.zoomFactor-b,n=s.scale(e,b);c.origin={x:c.origin.x+n.x,y:c.origin.y-n.y},c.zoomFactor=t,f(`Zoom: ${t} (m per pixel)`,4),g||y()}function G(e,t,n=1){n<=0&&(n=1);let o=s.subtract(e,t);return s.scale(o,1/n)}function Tt(){a.width,a.height;let e={x:640,y:-360},t={x:1140,y:-410},n={x:0,y:0},o={x:-110,y:-110};w(D(1e7,50),e,n),w(D(1e6,40),t,o)}function zt(e){l.running?tt():Ot()}function Q(){l.running&&tt(),l.clearObjects(),l.tickCount=0,y(),f(`Simulation Tick: ${l.tickCount}`,2)}function w(e,t,n,o){e===void 0&&(e=D()),t===void 0&&(t={x:0,y:0}),n===void 0&&(n={x:0,y:0});const i={body:e,position:t,velocity:n,acceleration:{x:0,y:0}};l.addObject(i)}function Ht(){Q(),f("Simulation running",1),document.getElementById("cvsBtnToggleSim").innerHTML="Pause",Tt(),l.run(),et()}function Ot(){l.running||(l.run(),et(),f("Simulation running",1),document.getElementById("cvsBtnToggleSim").innerHTML="Pause")}function tt(){l.running&&(g=!1,l.pause(),f("Simulation paused",1),document.getElementById("cvsBtnToggleSim").innerHTML="Play")}function et(){if(g)return;g=!0;const e=()=>{g&&(setTimeout(e,at),y(),f(`Simulation Tick: ${l.tickCount}`,2))};e()}function D(e,t){let n;return e===void 0?n=new v(Vt(20,200)):t===void 0?n=new v(e):n=new v(e,!0,"white",t),n}function Vt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}
//# sourceMappingURL=index-d44d2Q_g.js.map
