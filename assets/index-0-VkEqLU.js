var nt=Object.defineProperty;var ot=(e,t,n)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var m=(e,t,n)=>ot(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();class s{constructor(t,n){t===void 0&&(t=0),n===void 0&&(n=0),this.x=t,this.y=n}toString(){return`x: ${this.x}, y: ${this.y}`}static add(...t){return t.reduce((n,o)=>({x:n.x+o.x,y:n.y+o.y}),{x:0,y:0})}static subtract(t,n){return{x:t.x-n.x,y:t.y-n.y}}static scale(t,n){return{x:t.x*n,y:t.y*n}}static dotProduct(t,n){return t.x*n.x+t.y*n.y}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static normalize(t){const n=this.magnitude(t);return n===0?{x:0,y:0}:this.scale(t,1/n)}static distance(t,n){return Math.sqrt((n.x-t.x)**2+(n.y-t.y)**2)}static displacementVector(t,n){return this.subtract(n,t)}static hadamardProduct(t,n){return{x:t.x*n.x,y:t.y*n.y}}}const _=class _{constructor(t,n,o,i){m(this,"_mass");m(this,"_radius");m(this,"_color");m(this,"_movable");this.mass=t,i===void 0&&(i=this.defaultRadius(t)),this.radius=i,o===void 0&&(o="white"),this.color=o,n===void 0&&(n=!0),this.movable=n}get mass(){return this._mass}set mass(t){this._mass=t}get radius(){return this._radius}set radius(t){this._radius=t}get movable(){return this._movable}set movable(t){this._movable=t}get color(){return this._color}set color(t){CSS.supports("color",t)||(t="white"),this._color=t}defaultRadius(t){return t===void 0&&(t=this.mass),(3*t/(4*Math.PI*_.defaultDensity))**(1/3)}};m(_,"defaultDensity",1);let I=_;class it{constructor(){m(this,"_objectStates");m(this,"_running");m(this,"_tickCount");m(this,"_tickLength");m(this,"_collisionDetection");m(this,"_elasticCollisions");m(this,"_g");m(this,"gravityLowerBounds",1);this._objectStates=[],this._running=!1,this._tickCount=0,this._tickLength=10,this._collisionDetection=!1,this._elasticCollisions=!1,this._g=50}get objectStates(){return this._objectStates}set objectStates(t){this._objectStates=t}get running(){return this._running}set running(t){this._running=t}get tickCount(){return this._tickCount}set tickCount(t){this._tickCount=t}get tickLength(){return this._tickLength}set tickLength(t){this._tickLength=t}get collisionDetection(){return this._collisionDetection}set collisionDetection(t){this._collisionDetection=t}get elasticCollisions(){return this._elasticCollisions}set elasticCollisions(t){this._elasticCollisions=t}get g(){return this._g}set g(t){this._g=t}addObject(t){return t.body.movable||(t.velocity=new s(0,0)),this.objectStates.push(t)}clearObjects(){this.objectStates=[]}removeFromObjectStates(t){this.objectStates.splice(t,1)}pause(){this.running=!1}nextState(){this.updateAccelerationVectors(),this.objectStates.forEach(t=>{this.updateVelocityAndPosition(t)}),this.collisionDetection&&this.handleCollisions(),this.tickCount++}updateAccelerationVectors(){const t=this.calculateForces();this.objectStates.forEach((n,o)=>{const i=t.get(o);let c=i!==void 0?i:new s(0,0);c=s.scale(c,1/n.body.mass),n.acceleration=c})}calculateForces(){const t=new Map;for(let n=0;n<this.objectStates.length;n++)for(let o=n+1;o<this.objectStates.length;o++){const i=this.calculateForceBetweenBodies(n,o),c=s.scale(i,-1);t.set(n,s.add(t.get(n)||new s(0,0),i)),t.set(o,s.add(t.get(o)||new s(0,0),c))}return t}updateVelocityAndPosition(t){const n=this.tickLength/1e3;t.body.movable&&(t.velocity=s.add(t.velocity,s.scale(t.acceleration,n)),t.position=s.add(t.position,s.scale(t.velocity,n)))}calculateForceBetweenBodies(t,n){const o=this.objectStates[t],i=this.objectStates[n],c=s.distance(o.position,i.position);if(c<this.gravityLowerBounds||c===0)return new s(0,0);const r=this.g*(o.body.mass*i.body.mass/(c*c)),y=s.normalize(s.subtract(i.position,o.position));return s.scale(y,r)}handleCollisions(){for(let t=0;t<this.objectStates.length;t++){const n=this.objectStates[t];if(n!==void 0)for(let o=t+1;o<this.objectStates.length;o++){const i=this.objectStates[o],c=s.distance(n.position,i.position);c<=n.body.radius+i.body.radius&&(c<=n.body.radius||c<=i.body.radius?this.mergeBodies(t,o):this.elasticCollisions&&this.elasticCollision(n,i))}}}mergeBodies(t,n){const o=this.objectStates[t],i=this.objectStates[n],c=s.add(s.scale(o.velocity,o.body.mass),s.scale(i.velocity,i.body.mass)),r=o.body.mass+i.body.mass,y=s.scale(c,1/r);let d,b;i.body.mass>o.body.mass?(d=i,b=t):(d=o,b=n),d.velocity=y,d.body.mass=r,d.body.radius=d.body.defaultRadius(),d.body.movable=o.body.movable&&i.body.movable,d.body.movable||(d.velocity={x:0,y:0}),this.removeFromObjectStates(b)}elasticCollision(t,n,o=1){const c=s.displacementVector(t.position,n.position),r=s.magnitude(c);if(r<=1||r===0)return;const y=s.scale(c,1/r),d=s.subtract(n.velocity,t.velocity),b=s.dotProduct(d,y);if(b>0)return;const E=-(1+o)*b/(t.body.mass+n.body.mass),w=s.scale(y,E*n.body.mass),L=s.scale(y,E*t.body.mass);t.velocity=s.subtract(t.velocity,w),n.velocity=s.add(n.velocity,L)}run(){if(this.running)return;this.running=!0;const t=()=>{this.running&&(setTimeout(t,this.tickLength),this.nextState())};t()}}function Y(e){return e=e.trim(),!isNaN(+e)&&e.length!==0}function st(e){let t;return t=document.getElementById(e),t.value.trim()}function ct(e){let t;return t=st(e),Y(t)?+t:0}function S(e){let t;return typeof e=="string"?t=document.getElementById(e):t=e,t?t.checked:!1}var C=(e=>(e[e.None=0]="None",e[e.AddBody=1]="AddBody",e[e.ScrollCanvas=2]="ScrollCanvas",e))(C||{}),M=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e))(M||{});let u,h,z={fields:[]},l,a,at=25,f=!1,k=1,lt=.1,D,F,v=0,j=new s(0,0),x;document.addEventListener("DOMContentLoaded",X);function X(){Et(),rt(),Ct(1280,720),a={origin:{x:0,y:0},zoomFactor:1,orientationY:-1},l=new it,F=S("cbxDisplayVectors"),D=ct("massInput"),document.getElementById("massInput").step=W(),x=document.querySelector('input[name="cvsRadioBtnMouseAction"]:checked').value,l.collisionDetection=S("cbxCollisions"),l.elasticCollisions=S("cbxElasticCollisions"),document.getElementById("cbxElasticCollisions").disabled=!l.collisionDetection,document.removeEventListener("DOMContentLoaded",X)}function rt(){var e,t,n,o,i,c,r,y,d,b,E,w,L,H,N,R,A,U,Z;(e=document.getElementById("cvsBtnToggleSim"))==null||e.addEventListener("click",Tt),(t=document.getElementById("cvsBtnNextStep"))==null||t.addEventListener("click",zt),(n=document.getElementById("cvsBtnResetSim"))==null||n.addEventListener("click",Vt),(o=document.getElementById("cvsBtnZoomOut"))==null||o.addEventListener("click",jt),(i=document.getElementById("cvsBtnZoomIn"))==null||i.addEventListener("click",Pt),(c=document.getElementById("cvsBtnScrollLeft"))==null||c.addEventListener("click",_t),(r=document.getElementById("cvsBtnScrollRight"))==null||r.addEventListener("click",kt),(y=document.getElementById("cvsBtnScrollUp"))==null||y.addEventListener("click",Mt),(d=document.getElementById("cvsBtnScrollDown"))==null||d.addEventListener("click",Dt),(b=document.getElementById("theCanvas"))==null||b.addEventListener("mousedown",vt),(E=document.getElementById("theCanvas"))==null||E.addEventListener("mouseup",bt),(w=document.getElementById("theCanvas"))==null||w.addEventListener("mouseout",St),(L=document.getElementById("theCanvas"))==null||L.addEventListener("mousemove",pt),(H=document.getElementById("theCanvas"))==null||H.addEventListener("touchstart",ft),(N=document.getElementById("theCanvas"))==null||N.addEventListener("touchend",yt),(R=document.getElementById("massInput"))==null||R.addEventListener("change",ut),(A=document.getElementById("cbxDisplayVectors"))==null||A.addEventListener("change",ht),(U=document.getElementById("cbxCollisions"))==null||U.addEventListener("change",dt),(Z=document.getElementById("cbxElasticCollisions"))==null||Z.addEventListener("change",mt),document.querySelectorAll('input[name="cvsRadioBtnMouseAction"]').forEach(et=>{et.addEventListener("change",gt)})}function ut(){const e=this,t=e.value;D=Y(t)?+t:0,e.step=W()}function dt(e){const t=S(e.target),n=document.getElementById("cbxElasticCollisions"),o=S(n);l.collisionDetection=t,l.elasticCollisions=o,n.disabled=!t}function mt(e){const t=S(e.target);l.elasticCollisions=t}function ht(e){const t=e.target;F=t?t.checked:!1,f||p()}function gt(e){const t=e.target;t&&t.type==="radio"&&(x=t.value)}function ft(e){v=1;const t=Bt(e);switch(C[x]){case 0:console.log(t.toString());break;case 1:e.preventDefault(),j=t;break}}function yt(e){v=0;const t=xt(e);switch(C[x]){case 0:break;case 1:const n=K();if(n.mass<=0)break;const o=G(B(j),B(t));Q(n,B(t),o),g(`Number of Bodies: ${l.objectStates.length}`,1);break}f||p()}function vt(e){if(e.button!==0)return;v=1;const t=O(e);switch($("canvasMouseDownHandler:"+M[v]+" - at Position: "+t.toString()),C[x]){case 0:break;case 1:j=t;break}}function bt(e){if(e.button!==0||v===0)return;v=0;const t=O(e);switch($("canvasMouseUpHandler:"+M[v]+" - at Position: "+t.toString()),C[x]){case 0:break;case 1:const n=K();if(n.mass<=0)break;const o=G(B(j),B(t));Q(n,B(t),o),g(`Number of Bodies: ${l.objectStates.length}`,1);break}f||p()}function pt(e){const t=O(e);$("canvasMouseMoveHandler:"+M[v]+" - at Position: "+t.toString())}function St(e){v=0}function O(e){const t=u.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;return new s(n,o)}function Bt(e){const t=u.getBoundingClientRect(),n=e.touches[0];return new s(n.clientX-t.left,n.clientY-t.top)}function xt(e){const t=u.getBoundingClientRect(),n=e.changedTouches[0];return new s(n.clientX-t.left,n.clientY-t.top)}function W(){let e=10**(Math.floor(Math.log10(D))-1);return e<1?"1":e.toString()}function Et(){const e="statusText";let t=1,n=document.getElementById(e+t);for(;n!==null;)z.fields.push(n),t++,n=document.getElementById(e+t)}function K(){const e=S("cvsCbxBodyMovable");return new I(D,e)}function g(e,t,n=!1){let o;typeof t=="number"?o=z.fields[t-1]:typeof t=="string"?o=document.getElementById(t):o=z.fields[0],n?o.innerHTML+=e:o.innerHTML=e}function Ct(e,t){u=document.getElementById("theCanvas"),u.width=e,u.height=t,h=u.getContext("2d"),g(`Canvas dimension: ${e} * ${t}`,5)}function $(e){const t=new Date,n=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),i=t.getSeconds().toString().padStart(2,"0"),c=t.getMilliseconds().toString().padStart(3,"0"),r=`${n}:${o}:${i}.${c}`;console.log(`[${r}] ${e}`)}function q(e,t,n){n===void 0&&(n="white");let o=s.add(e,t);h.beginPath(),h.lineWidth=3,h.strokeStyle=n,h.moveTo(e.x,e.y),h.lineTo(o.x,o.y),h.stroke()}function wt(e,t){let n=Math.max(e.radius/a.zoomFactor,1);h.beginPath(),h.arc(t.x,t.y,n,0,Math.PI*2),h.closePath(),h.fillStyle=e.color,h.fill()}function Lt(){l.objectStates.forEach(t=>{t!==null&&wt(t.body,V(t.position))})}function p(){h.clearRect(0,0,u.width,u.height),Lt(),F&&It()}function It(){l.objectStates.forEach(e=>{q(V(e.position),J(e.acceleration),"green"),q(V(e.position),J(e.velocity),"red")})}function V(e){const t=s.subtract(e,a.origin),n={x:t.x,y:t.y*-1};return s.scale(n,1/a.zoomFactor)}function J(e){const t={x:e.x,y:e.y*-1};return s.scale(t,1/a.zoomFactor)}function B(e){let t;return t=s.add(s.hadamardProduct(s.scale(e,a.zoomFactor),{x:1,y:a.orientationY}),a.origin),t}function P(e){a.origin=e,f||p()}function kt(){let e=T("horizontal");P({x:a.origin.x+e,y:a.origin.y})}function _t(){let e=T("horizontal");P({x:a.origin.x-e,y:a.origin.y})}function Mt(){let e=T("vertical");P({x:a.origin.x,y:a.origin.y+e})}function Dt(){let e=T("vertical");P({x:a.origin.x,y:a.origin.y-e})}function T(e,t){switch(t===void 0&&(t=lt),e){case"horizontal":return u.width*t*a.zoomFactor;case"vertical":return u.height*t*a.zoomFactor}}function jt(){const e={x:u.width/2,y:u.height/2},t=a.zoomFactor+k;let n=s.scale(e,k);a.origin={x:a.origin.x-n.x,y:a.origin.y+n.y},a.zoomFactor=t,g(`Zoom: ${t} (m per pixel)`,4),f||p()}function Pt(){if(a.zoomFactor<=1)return;let e={x:u.width/2,y:u.height/2},t=a.zoomFactor-k,n=s.scale(e,k);a.origin={x:a.origin.x+n.x,y:a.origin.y-n.y},a.zoomFactor=t,g(`Zoom: ${t} (m per pixel)`,4),f||p()}function G(e,t,n=1){n<=0&&(n=1);let o=s.subtract(e,t);return s.scale(o,1/n)}function Tt(e){l.running?tt():Ft()}function zt(){f||(l.nextState(),p(),g(`Simulation Tick: ${l.tickCount}`,2),g(`Number of Bodies: ${l.objectStates.length}`,1))}function Vt(){l.running&&tt(),l.clearObjects(),l.tickCount=0,p(),g(`Simulation Tick: ${l.tickCount}`,2),g(`Number of Bodies: ${l.objectStates.length}`,1)}function Q(e,t,n,o){e===void 0&&(e=$t()),t===void 0&&(t={x:0,y:0}),n===void 0&&(n={x:0,y:0});const i={body:e,position:t,velocity:n,acceleration:{x:0,y:0}};l.addObject(i)}function Ft(){l.running||(l.run(),Ot(),g(`Number of Bodies: ${l.objectStates.length}`,1),document.getElementById("cvsBtnToggleSim").innerHTML="Pause")}function tt(){l.running&&(f=!1,l.pause(),document.getElementById("cvsBtnToggleSim").innerHTML="Play")}function Ot(){if(f)return;f=!0;const e=()=>{f&&(setTimeout(e,at),p(),g(`Simulation Tick: ${l.tickCount}`,2),g(`Number of Bodies: ${l.objectStates.length}`,1))};e()}function $t(e,t){let n;return n=new I(Ht(20,200)),n}function Ht(e,t){return Math.floor(Math.random()*(t-e+1)+e)}
//# sourceMappingURL=index-0-VkEqLU.js.map
